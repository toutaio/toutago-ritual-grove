ritual:
  name: minimal
  version: 1.0.0
  description: Minimal Toutā application with basic structure
  author: Toutā Team
  tags:
    - minimal
    - starter
    - basic

compatibility:
  min_touta_version: 1.0.0
  go_version: ">=1.21"

dependencies:
  packages:
    - github.com/toutaio/toutago

questions:
  - name: project_name
    type: text
    prompt: "What is your project name?"
    required: true
    validate:
      pattern: "^[a-z][a-z0-9-]*$"
    default: "my-app"

  - name: module_name
    type: text
    prompt: "What is your Go module name?"
    required: true
    default: "github.com/yourusername/my-app"

  - name: port
    type: number
    prompt: "What port should the server listen on?"
    default: 8080
    validate:
      min: 1024
      max: 65535

  - name: enable_docker
    type: boolean
    prompt: "Enable Docker support?"
    default: true

files:
  templates:
    - src: main.go.tmpl
      dest: cmd/{{ .project_name }}/main.go

    - src: README.md.tmpl
      dest: README.md

    - src: go.mod.tmpl
      dest: go.mod

    - src: gitignore.tmpl
      dest: .gitignore

    # Docker support files (conditional)
    - src: _shared:docker/Dockerfile.go.tmpl
      dest: Dockerfile
      condition: "enable_docker"

    - src: _shared:docker/docker-compose.yml.tmpl
      dest: docker-compose.yml
      condition: "enable_docker"

    - src: _shared:docker/.dockerignore.tmpl
      dest: .dockerignore
      condition: "enable_docker"

    - src: _shared:docker/.air.toml.tmpl
      dest: .air.toml
      condition: "enable_docker"

    - src: _shared:docker/.env.example.tmpl
    
    # Create ready-to-use .env file with user's answers
    - src: _shared:docker/.env.example.tmpl
      dest: .env
      condition: "enable_docker"
      dest: .env.example
      condition: "enable_docker"

    - src: _shared:docs/DOCKER.md.tmpl
      dest: DOCKER.md
      condition: "enable_docker"

  static:
    - src: _shared:docker/wait-for-it.sh
      dest: wait-for-it.sh
      condition: "enable_docker"

hooks:
  post_install:
    - "go mod tidy"
    - "go fmt ./..."
